{{ if .is_debian -}}
#!/usr/bin/env bash
# Install CLI tools on Debian that aren't available via apt
# These tools are typically installed via cargo or downloaded from GitHub releases

set -euo pipefail

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "ğŸ› ï¸  Installing CLI tools for Debian"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

# Ensure directories exist
mkdir -p ~/.local/bin
mkdir -p ~/.cargo/bin

# Check if cargo is available
if ! command -v cargo &>/dev/null; then
    echo "ğŸ“¦ Installing Rust toolchain..."
    curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y
    source ~/.cargo/env
fi

# Function to check if a command exists
has_cmd() {
    command -v "$1" &>/dev/null
}

# Function to get latest GitHub release
get_latest_release() {
    curl -sL "https://api.github.com/repos/$1/releases/latest" | grep '"tag_name":' | sed -E 's/.*"([^"]+)".*/\1/'
}

echo ""
echo "ğŸ“¦ Installing tools via cargo..."

# Helix editor - if not installed or outdated
if ! has_cmd hx; then
    echo "  â†’ Installing helix..."
    cargo install --locked helix-term
    echo "  âœ“ helix installed"
else
    echo "  âœ“ helix already installed"
fi

# Bat - syntax highlighting cat
if ! has_cmd bat; then
    echo "  â†’ Installing bat..."
    cargo install --locked bat
    echo "  âœ“ bat installed"
else
    echo "  âœ“ bat already installed"
fi

# Zoxide - smart cd
if ! has_cmd zoxide; then
    echo "  â†’ Installing zoxide..."
    cargo install --locked zoxide
    echo "  âœ“ zoxide installed"
else
    echo "  âœ“ zoxide already installed"
fi

# fd - better find
if ! has_cmd fd; then
    echo "  â†’ Installing fd..."
    cargo install --locked fd-find
    echo "  âœ“ fd installed"
else
    echo "  âœ“ fd already installed"
fi

# lsd - modern ls (optional, may take a while)
if ! has_cmd lsd; then
    echo "  â†’ Installing lsd..."
    cargo install --locked lsd
    echo "  âœ“ lsd installed"
else
    echo "  âœ“ lsd already installed"
fi

echo ""
echo "ğŸ“¦ Installing tools from GitHub releases..."

# LF file manager
if ! has_cmd lf; then
    echo "  â†’ Installing lf..."
    LF_VERSION=$(get_latest_release "gokcehan/lf")
    curl -sL "https://github.com/gokcehan/lf/releases/download/${LF_VERSION}/lf-linux-amd64.tar.gz" | tar xz -C ~/.local/bin
    chmod +x ~/.local/bin/lf
    echo "  âœ“ lf installed (${LF_VERSION})"
else
    echo "  âœ“ lf already installed"
fi

# Lazygit
if ! has_cmd lazygit; then
    echo "  â†’ Installing lazygit..."
    LAZYGIT_VERSION=$(get_latest_release "jesseduffield/lazygit" | sed 's/^v//')
    curl -sL "https://github.com/jesseduffield/lazygit/releases/download/v${LAZYGIT_VERSION}/lazygit_${LAZYGIT_VERSION}_Linux_x86_64.tar.gz" | tar xz -C ~/.local/bin lazygit
    chmod +x ~/.local/bin/lazygit
    echo "  âœ“ lazygit installed (v${LAZYGIT_VERSION})"
else
    echo "  âœ“ lazygit already installed"
fi

echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "âœ… CLI tools installation complete"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "Installed tools:"
echo "  â€¢ helix (hx)  - Modal editor"
echo "  â€¢ bat         - Syntax-highlighted cat"
echo "  â€¢ zoxide (z)  - Smart directory jumping"
echo "  â€¢ fd          - Better find"
echo "  â€¢ lsd         - Modern ls with icons"
echo "  â€¢ lf          - Terminal file manager"
echo "  â€¢ lazygit     - Git TUI"
echo ""
echo "ğŸ’¡ Run 'source ~/.cargo/env' or restart your shell to use cargo tools"
{{ end -}}
