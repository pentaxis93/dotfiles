# MPV Input Configuration - Helix-Native Vi Keybindings
# "Do not define keybindings; define intentions"
{{- $kb := .keybindings }}

# ============================================================================
# NAVIGATION - Move through video without changing state
# ============================================================================
# Helix-native: hjkl for movement - Semantic keybindings

{{ template "keybind-mpv.tmpl" dict "category" "navigate" "action" "prev" "command" "seek -5" "comment" "Navigate prev: 5 seconds back" "keybindings" $kb }}
{{ template "keybind-mpv.tmpl" dict "category" "navigate" "action" "next" "command" "seek  5" "comment" "Navigate next: 5 seconds forward" "keybindings" $kb }}
{{ template "keybind-mpv.tmpl" dict "category" "navigate" "action" "down" "command" "seek -60" "comment" "Navigate down: 1 minute back" "keybindings" $kb }}
{{ template "keybind-mpv.tmpl" dict "category" "navigate" "action" "up" "command" "seek  60" "comment" "Navigate up: 1 minute forward" "keybindings" $kb }}

H     seek -10                   # Semantic navigate: 10 seconds back (large step)
L     seek  10                   # Semantic navigate: 10 seconds forward (large step)
J     playlist-prev              # Semantic navigate: Previous in playlist
K     playlist-next              # Semantic navigate: Next in playlist

# Line/File navigation (Helix semantic) - MPV uses single-key alternatives
{{ template "keybind-mpv.tmpl" dict "category" "navigate" "action" "line_start" "command" "seek 0 absolute-percent" "comment" "Go home: Start of video" "custom_key" "0" "keybindings" $kb }}
{{ template "keybind-mpv.tmpl" dict "category" "navigate" "action" "line_end" "command" "seek 100 absolute-percent" "comment" "Go line end: End of video" "custom_key" "$" "keybindings" $kb }}
{{ template "keybind-mpv.tmpl" dict "category" "navigate" "action" "file_start" "command" "seek 0 absolute" "comment" "Go to beginning" "custom_key" "HOME" "keybindings" $kb }}
{{ template "keybind-mpv.tmpl" dict "category" "navigate" "action" "file_end" "command" "seek 100 absolute-percent" "comment" "Go end (Helix spirit)" "custom_key" "END" "keybindings" $kb }}

# Word-like navigation (chapters) - Semantic keybindings
{{ template "keybind-mpv.tmpl" dict "category" "navigate" "action" "word_next" "command" "add chapter 1" "comment" "Word next: Next chapter" "keybindings" $kb }}
{{ template "keybind-mpv.tmpl" dict "category" "navigate" "action" "word_prev" "command" "add chapter -1" "comment" "Word prev: Previous chapter" "keybindings" $kb }}

# ============================================================================
# MANIPULATION - Modify playback parameters
# ============================================================================
# Semantic keybindings with Ctrl modifier

{{ template "keybind-mpv.tmpl" dict "category" "manipulate" "action" "move_prev" "command" "add speed -0.1" "comment" "Manipulate: Slow down" "modifier" "Ctrl" "keybindings" $kb }}
{{ template "keybind-mpv.tmpl" dict "category" "manipulate" "action" "move_next" "command" "add speed 0.1" "comment" "Manipulate: Speed up" "modifier" "Ctrl" "keybindings" $kb }}
{{ template "keybind-mpv.tmpl" dict "category" "manipulate" "action" "move_down" "command" "add volume -2" "comment" "Manipulate: Volume down" "modifier" "Ctrl" "keybindings" $kb }}
{{ template "keybind-mpv.tmpl" dict "category" "manipulate" "action" "move_up" "command" "add volume 2" "comment" "Manipulate: Volume up" "modifier" "Ctrl" "keybindings" $kb }}

# Fine control - Semantic manipulate: Direct adjustments
+     add volume 2               # Semantic manipulate: Increase volume
-     add volume -2              # Semantic manipulate: Decrease volume
=     set speed 1.0              # Semantic manipulate: Reset speed
0     set volume 100             # Semantic manipulate: Reset volume

# ============================================================================
# TRANSFORMATION - Toggle states/modes
# ============================================================================
# Semantic keybindings

{{ template "keybind-mpv.tmpl" dict "category" "transform" "action" "fullscreen" "command" "cycle fullscreen" "comment" "Transform: Toggle fullscreen" "keybindings" $kb }}
{{ template "keybind-mpv.tmpl" dict "category" "transform" "action" "mode_insert" "command" "show-text \"${filename}\"" "comment" "Info mode: Show filename" "keybindings" $kb }}
{{ template "keybind-mpv.tmpl" dict "category" "transform" "action" "mode_select" "command" "cycle sub-visibility" "comment" "Visual: Toggle subtitles" "keybindings" $kb }}
m     cycle mute                 # Semantic transform: Mute toggle
t     cycle ontop                # Semantic transform: Always on top
p     show-progress              # Semantic transform: Progress bar

# ============================================================================
# PRESERVATION - Save state
# ============================================================================
# Semantic keybindings

{{ template "keybind-mpv.tmpl" dict "category" "preserve" "action" "current" "command" "screenshot" "comment" "Save screenshot" "keybindings" $kb }}
S     screenshot video           # Semantic preserve: Save without subtitles
Ctrl+s write-watch-later-config # Semantic preserve: Save position manually

# ============================================================================
# DISCOVERY - Search/browse content
# ============================================================================
# Semantic keybindings

{{ template "keybind-mpv.tmpl" dict "category" "discover" "action" "search_forward" "command" "script-binding console/enable" "comment" "Search forward (console)" "keybindings" $kb }}
{{ template "keybind-mpv.tmpl" dict "category" "discover" "action" "help" "command" "script-binding stats/display-stats" "comment" "Help: Show statistics" "keybindings" $kb }}
b     script-binding open-lf              # Semantic discover: Browse - Open lf file browser
B     script-binding open-lf              # Semantic discover: Browse - Open lf file browser (same as b)
Tab   script-binding stats/display-stats-toggle # Semantic discover: Stats toggle

# ============================================================================
# SELECTION - Choose/activate
# ============================================================================
# Semantic keybindings

{{ template "keybind-mpv.tmpl" dict "category" "select" "action" "toggle" "command" "cycle pause" "comment" "Toggle selection: Play/Pause" "keybindings" $kb }}
Enter cycle pause                # Semantic select: Alternative pause toggle
a     cycle audio                # Semantic select: Audio track selection

# ============================================================================
# SUBTITLE CONTROL - Comprehensive subtitle management
# ============================================================================
# Application-specific bindings with semantic comments

# Primary subtitles - Semantic transform and select
v     cycle sub-visibility       # Semantic transform: Toggle subtitle visibility (v for visual)
V     cycle secondary-sub-visibility # Semantic transform: Toggle secondary subtitles
s     cycle sub                  # Semantic select: Cycle through available subtitles
S     cycle sub down             # Semantic select: Cycle backwards through subtitles
Alt+s cycle secondary-sid        # Semantic select: Cycle secondary subtitle track

# Subtitle timing - Semantic manipulate: Timing adjustments
z     add sub-delay -0.1         # Semantic manipulate: Shift subtitles earlier
x     add sub-delay +0.1         # Semantic manipulate: Shift subtitles later
Z     set sub-delay 0            # Semantic manipulate: Reset subtitle delay

# Subtitle positioning - Semantic manipulate: Position adjustments
Alt+j add sub-pos +1             # Semantic manipulate: Move subtitles down
Alt+k add sub-pos -1             # Semantic manipulate: Move subtitles up
Alt+r set sub-pos 95             # Semantic manipulate: Reset subtitle position

# Subtitle sizing - Semantic manipulate: Size adjustments
Alt++ add sub-scale +0.1         # Semantic manipulate: Increase subtitle size
Alt+- add sub-scale -0.1         # Semantic manipulate: Decrease subtitle size
Alt+0 set sub-scale 1.0          # Semantic manipulate: Reset subtitle size

# Subtitle styling - Semantic transform: Style toggles
Alt+b cycle-values sub-bold "yes" "no"     # Semantic transform: Toggle bold
Alt+i cycle-values sub-italic "yes" "no"   # Semantic transform: Toggle italic
Alt+u cycle-values sub-border-size "0" "1" "2" "3" "4" # Semantic transform: Cycle border size

# Load external subtitles - Semantic select and dismiss
Alt+f script-message-to console type "sub-add " # Semantic select: Type path to load subtitle file
Alt+F sub-remove                 # Semantic dismiss: Remove current external subtitle

# ============================================================================
# DISMISSAL - Close/quit
# ============================================================================
# Semantic keybindings

{{ template "keybind-mpv.tmpl" dict "category" "dismiss" "action" "current" "command" "quit-watch-later" "comment" "Quit and save position" "keybindings" $kb }}
{{ template "keybind-mpv.tmpl" dict "category" "dismiss" "action" "cancel" "command" "set fullscreen no" "comment" "Escape fullscreen" "keybindings" $kb }}

# ============================================================================
# PLAYLIST MANAGEMENT
# ============================================================================
# Application-specific with semantic comments

n     playlist-next              # Semantic navigate: Next in playlist
N     playlist-prev              # Semantic navigate: Previous in playlist
>     playlist-next              # Semantic navigate: Alternative next
<     playlist-prev              # Semantic navigate: Alternative prev
P     script-binding console/enable # Semantic invoke: Playlist console

# ============================================================================
# ADVANCED CONTROLS
# ============================================================================
# Application-specific with semantic comments

c     cycle-values video-rotate "90" "180" "270" "0" # Semantic manipulate: Cycle rotation
r     set video-rotate 0         # Semantic manipulate: Reset rotation
d     cycle deinterlace          # Semantic transform: Deinterlace toggle
A     cycle-values video-aspect-override "16:9" "4:3" "2.35:1" "-1" # Semantic manipulate: Aspect ratio

# ============================================================================
# MOUSE BINDINGS
# ============================================================================
# Semantic mouse operations

WHEEL_UP      add volume 2       # Semantic manipulate: Volume up (mouse)
WHEEL_DOWN    add volume -2      # Semantic manipulate: Volume down (mouse)
WHEEL_LEFT    seek -10           # Semantic navigate: Seek back (mouse)
WHEEL_RIGHT   seek 10            # Semantic navigate: Seek forward (mouse)
MBTN_LEFT     cycle pause        # Semantic select: Toggle pause (mouse)
MBTN_LEFT_DBL cycle fullscreen   # Semantic transform: Toggle fullscreen (double-click)
MBTN_RIGHT    quit-watch-later   # Semantic dismiss: Quit and save (right-click)